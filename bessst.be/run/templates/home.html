{% extends "base.html" %}
{% load i18n utils thumbnails %}

<title>{% trans "BESSST - Brussels, Heritage and Silence" %} - {% block title %}{% endblock %}</title>

{% block slug %}home{% endblock%}


{% block nav %}

<nav>
    <ul id="logo">
        <li><a href="/"><img src="{{ STATIC_URL }}images/logo.png" /></a></li>
    </ul>
    <ul id="navi">
        <li><a id="menu-projects" href="{% url projects %}">{% trans "Projects" %}</a></li>
        <li><a id="menu-agenda" href="{% url agenda %}">{% trans "Calendar" %}</a></li>
        <li><a id="menu-community" href="{% url community %}">{% trans "Community" %}</a></li>        
        <li><a id="menu-inspiratie" href="{% url inspiration %}">{% trans "Inspiration" %}</a></li>
        <li><a id="menu-over" href="{% url flatpage-detail slug="over" %}">{% trans "About" %}</a></li>
    </ul>
    <form action="/i18n/setlang/" method="post">
        {% csrf_token %}
        <input name="next" type="hidden" value="{{ redirect_to }}" />
        {% get_language_info_list for LANGUAGES as languages %}
        <ul id="lan">
        {% for language in languages %}
            <li class='{% if LANGUAGE_CODE == language.code %}selected{% endif %}'><button name="language" value="{{ language.code }}">{{ language.code }}</button></li>
        {% endfor %}
        </ul>
    </form>
</nav>

{% endblock %}



{% block content %}
<div id="axis-home" title="{{ object_list.0.name }}"><a href="{% url axis-detail slug=object_list.0.slug %}">{% get_trans object_list.0 name LANGUAGE_CODE %}</a></div>
{% endblock %}

{% block background %}
    {% for axis in object_list reversed %}
    <img {% if not forloop.last %}style='display: none;'{% endif %} class="background-image axis-image" id="background-{{ axis.slug }}" src="{{ axis.image_set.all.0.image|thumbnail:'1200w' }}" />
    {% endfor %}
{% endblock %}

{% block footer %}
{% endblock %}

{% block extra_js %}
    <script>
        var photos = {
        	_i : 1,
        	axes: [
					{% for axis in object_list %}
					    { 'slug' : '{{ axis.slug }}',
					     'name' : '{% get_trans axis name LANGUAGE_CODE %}',
					     'photo' : '{{ axis.image_set.all.0.image.url }}',
					     'photoCaption' : '{{ axis.image_set.all.0 }}',
					     'url' : '{% url axis-detail slug=axis.slug %}' },
					{% endfor %}
					],
            get_axis : function() {
                if (this._i >= this.axes.length) {
                    this._i = 0;
                }
                var axis = this.axes[this._i];
                this._i += 1;
                return axis
            },
	        slide: function(){
	            // background image and caption
	            var axis = this.get_axis();
	            $('img.background-image').not('img#background-' + axis.slug).fadeOut('slow');
	            $('img#background-' + axis.slug).fadeIn('slow');
	
	            //console.log('img#background-' + axis.slug);
	            $("footer .caption").text(axis.photoCaption).show();

	            $("#axis-home").html('<a href="' + axis.url + '">' + axis.name + '</a>').show();
                left = $(document).width()/2 - $("#axis-home").width()/2 ;
	            $("#axis-home").css('left', left + 'px');
	        }
        }
    
        $(window).load(function() {
            window.setInterval(function() { photos.slide(); }, 5000);
        });

    </script>
{% endblock %}
